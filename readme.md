# aimedison 챗봇 연동 & 쇼핑몰 데이터 문서화 및 RAG

## 개요
- 화·수·목에 배우고 실습한 RAG내용들을 바탕으로 쇼핑몰에 최적화된 챗봇 개발에 힘씀

- 카페24 정책 & 온라인쇼핑몰 환불 정책 등을 크롤링 및 정형화하여 RAG 작업을 진행함

## 수집대상 문서
### 반품 · 취소 · 환불 정책 문서
- 쇼핑몰 고객이 가장 많은 질문을 하는 내용
- 반품 기한, 비용 부담, 상품군별 제한 조건 등등 제시한 문서 RAG
- 문서 원문 기준으로 크롤링 후 정제

### 전자상거래 표준 약관 ( 카페24 개발자 페이지의 약관 정책 기반 )
- 공정거래위원회 표준 약관을 기반으로 한 쇼핑몰 약관
- 청약철회, 배송 책임, 환불 조건, 분쟁해결 조항이 포함됨
- 법적 기준이 되는 문서라서 RAG 신뢰도에 최적화되어있음

## 파이프라인
```
웹 페이지 / 텍스트 문서
 → 크롤링
 → 텍스트 정제
 → 마크다운 구조화
 → 의미 단위 Chunking
 → Embedding
 → Vector DB 저장
 → RAG 응답
```

**1. 원문 확보**
- 공정거래위원회 표준 약관으로 구성된 '카페24 정책'은 텍스트 파일로 가져올 수 있었음

- 반품 취소 환불 정책문서는 쿠팡의 정책들이 이미지로 설명되어 있는 페이지를 GPT · OCR을 통해 읽은 후 정제화해 문서화함

**2. 텍스트 정제**
- RAG할 문서들은 JSON으로 입력받음
- 하지만 문서용 특수기호 때문에 422 오류가 나는 것을 확인

    -> 특수기호들을 제거하고 유니코드 따옴표로 통일시키는 작업 진행

    == 문서 임베딩 성공

**3. 청킹 전략**
- 임베딩한 문서들은 전부 정책, 조항들이 들어있음
- 정책과 조항이 가장 읽히기 좋은 청킹 단위는 **토큰 200 ~ 600 사이**라고 함
- 토큰단위 청킹을 시도하였지만 의존성 문제와 구현 난이도때문에 문자열 양으로 청킹을 진행

    -> 문자열 1500자 기준으로 청킹, 문서의 조사·숫자·기호·줄바꿈 고려하여 정한 수치

    원래 900 ~ 1200토큰 정도 되는 문자열 양이지만 ( 영문 혼합 기준 ) 
    
    **고려사항 적합 시 4 ~ 600토큰정도로 추청됨**

## 결론
- 법적 효력이 있는 문서를 임베딩했다는 점에서 신뢰도가 올라가는 느낌을 받았다.

- RAG의 순기능인 LLM의 아는 척을 거의 없앤

    순수 실제 내용으로 답변하는 챗봇을 구현한다는 점에서 실사용으로도 매우 중요한 작업이었다고 생각한다.

## 제언 및 부족한점
- 청킹 단위를 토큰으로 바꾸는 작업을 이어서 해보고 싶다.
- 쇼핑몰의 경우 판매하는 물품마다 환불 정책이 다를 것 같은데, 소소한 차이들을 전부 구별할 수 있는 챗봇 구현을 목표로 더 많은 문서들을 모아 임베딩할 것이라고 노력할 것이다.